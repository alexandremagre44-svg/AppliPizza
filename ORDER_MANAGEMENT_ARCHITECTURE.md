# Architecture du Module de Gestion des Commandes

## ğŸ“ Diagramme de l'Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      INTERFACE UTILISATEUR                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚          AdminOrdersScreen (Main Screen)                     â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚  â”‚ SearchBar    â”‚  â”‚ FilterDialog â”‚  â”‚ ExportButton â”‚      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚  Toggle: TableView â†” CardView                       â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚  â”‚  â”‚  OrderTableView  â”‚    OR   â”‚  OrderCardView   â”‚          â”‚   â”‚
â”‚  â”‚  â”‚                  â”‚         â”‚                  â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  - Columns       â”‚         â”‚  - Grid Cards    â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  - Sort headers  â”‚         â”‚  - Visual info   â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  - Row click â†’   â”‚         â”‚  - Card click â†’  â”‚          â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚  â”‚           â”‚                             â”‚                     â”‚   â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
â”‚  â”‚                         â†“                                     â”‚   â”‚
â”‚  â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚   â”‚
â”‚  â”‚           â”‚   OrderDetailPanel           â”‚                   â”‚   â”‚
â”‚  â”‚           â”‚   (Slide Animation)          â”‚                   â”‚   â”‚
â”‚  â”‚           â”‚                              â”‚                   â”‚   â”‚
â”‚  â”‚           â”‚  - Customer info             â”‚                   â”‚   â”‚
â”‚  â”‚           â”‚  - Products list             â”‚                   â”‚   â”‚
â”‚  â”‚           â”‚  - OrderStatusBadge          â”‚                   â”‚   â”‚
â”‚  â”‚           â”‚  - History timeline          â”‚                   â”‚   â”‚
â”‚  â”‚           â”‚  - Action buttons            â”‚                   â”‚   â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚          NewOrderNotification (Overlay)                       â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚  ğŸ”” Nouvelle commande !                    â”‚              â”‚   â”‚
â”‚  â”‚  â”‚  [View] [Dismiss]                          â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â”‚           â†‘ Appears on new unviewed order                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      GESTION D'Ã‰TAT (RIVERPOD)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  ordersStreamProvider                                      â”‚      â”‚
â”‚  â”‚  â””â”€> Stream<List<Order>>                                  â”‚      â”‚
â”‚  â”‚       - Ã‰coute OrderService.ordersStream                   â”‚      â”‚
â”‚  â”‚       - Auto-rebuild on change                             â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                         â†“                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  ordersViewProvider                                        â”‚      â”‚
â”‚  â”‚  â””â”€> OrdersViewState                                      â”‚      â”‚
â”‚  â”‚       - statusFilter                                       â”‚      â”‚
â”‚  â”‚       - dateRangeFilter                                    â”‚      â”‚
â”‚  â”‚       - searchQuery                                        â”‚      â”‚
â”‚  â”‚       - sortBy / sortAscending                            â”‚      â”‚
â”‚  â”‚       - isTableView                                        â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                         â†“                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  filteredOrdersProvider (Computed)                        â”‚      â”‚
â”‚  â”‚  â””â”€> List<Order>                                          â”‚      â”‚
â”‚  â”‚       - Apply filters                                      â”‚      â”‚
â”‚  â”‚       - Apply search                                       â”‚      â”‚
â”‚  â”‚       - Apply sort                                         â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                         â†“                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  unviewedOrdersProvider (Computed)                        â”‚      â”‚
â”‚  â”‚  â””â”€> List<Order> where !isViewed                         â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                         â†“                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  unviewedOrdersCountProvider (Computed)                   â”‚      â”‚
â”‚  â”‚  â””â”€> int (badge counter)                                  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SERVICES & DONNÃ‰ES                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  OrderService (Singleton)                                  â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”‚
â”‚  â”‚  â”‚  StreamController<List<Order>>                      â”‚  â”‚      â”‚
â”‚  â”‚  â”‚  â””â”€> ordersStream (broadcast)                       â”‚  â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚  Methods:                                                   â”‚      â”‚
â”‚  â”‚  â€¢ addOrder(Order)                                         â”‚      â”‚
â”‚  â”‚  â€¢ updateOrder(Order)                                      â”‚      â”‚
â”‚  â”‚  â€¢ updateOrderStatus(id, status, note)                    â”‚      â”‚
â”‚  â”‚  â€¢ markOrderAsViewed(id)                                  â”‚      â”‚
â”‚  â”‚  â€¢ deleteOrder(id)                                         â”‚      â”‚
â”‚  â”‚  â€¢ getOrderById(id)                                        â”‚      â”‚
â”‚  â”‚  â€¢ getUnviewedOrders()                                    â”‚      â”‚
â”‚  â”‚  â€¢ getOrdersByStatus(status)                              â”‚      â”‚
â”‚  â”‚  â€¢ getOrdersByDateRange(start, end)                       â”‚      â”‚
â”‚  â”‚  â€¢ searchOrders(query)                                    â”‚      â”‚
â”‚  â”‚  â€¢ refresh()                                               â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚  Cache: List<Order> _cachedOrders                         â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                         â†“ â†‘                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  SharedPreferences                                         â”‚      â”‚
â”‚  â”‚  Key: "orders_list"                                        â”‚      â”‚
â”‚  â”‚  Format: JSON Array                                        â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”‚
â”‚  â”‚  â”‚  [                                                   â”‚  â”‚      â”‚
â”‚  â”‚  â”‚    {                                                 â”‚  â”‚      â”‚
â”‚  â”‚  â”‚      "id": "uuid",                                   â”‚  â”‚      â”‚
â”‚  â”‚  â”‚      "total": 25.50,                                â”‚  â”‚      â”‚
â”‚  â”‚  â”‚      "date": "2024-11-12T16:00:00Z",               â”‚  â”‚      â”‚
â”‚  â”‚  â”‚      "status": "En attente",                        â”‚  â”‚      â”‚
â”‚  â”‚  â”‚      "customerName": "Jean Dupont",                 â”‚  â”‚      â”‚
â”‚  â”‚  â”‚      "items": [...],                                â”‚  â”‚      â”‚
â”‚  â”‚  â”‚      "statusHistory": [...],                        â”‚  â”‚      â”‚
â”‚  â”‚  â”‚      "isViewed": false,                             â”‚  â”‚      â”‚
â”‚  â”‚  â”‚      ...                                            â”‚  â”‚      â”‚
â”‚  â”‚  â”‚    },                                                â”‚  â”‚      â”‚
â”‚  â”‚  â”‚    ...                                               â”‚  â”‚      â”‚
â”‚  â”‚  â”‚  ]                                                   â”‚  â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MODÃˆLES DE DONNÃ‰ES                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  Order                                                                â”‚
â”‚  â”œâ”€ id: String                                                       â”‚
â”‚  â”œâ”€ total: double                                                    â”‚
â”‚  â”œâ”€ date: DateTime                                                   â”‚
â”‚  â”œâ”€ items: List<CartItem>                                           â”‚
â”‚  â”œâ”€ status: String                                                   â”‚
â”‚  â”œâ”€ customerName: String?                                           â”‚
â”‚  â”œâ”€ customerPhone: String?                                          â”‚
â”‚  â”œâ”€ customerEmail: String?                                          â”‚
â”‚  â”œâ”€ comment: String?                                                â”‚
â”‚  â”œâ”€ statusHistory: List<OrderStatusHistory>?                       â”‚
â”‚  â”œâ”€ isViewed: bool                                                  â”‚
â”‚  â”œâ”€ viewedAt: DateTime?                                             â”‚
â”‚  â”œâ”€ pickupDate: String?                                             â”‚
â”‚  â””â”€ pickupTimeSlot: String?                                         â”‚
â”‚                                                                       â”‚
â”‚  OrderStatus (Constants)                                             â”‚
â”‚  â”œâ”€ pending = "En attente"                                          â”‚
â”‚  â”œâ”€ preparing = "En prÃ©paration"                                    â”‚
â”‚  â”œâ”€ ready = "PrÃªte"                                                 â”‚
â”‚  â”œâ”€ delivered = "LivrÃ©e"                                            â”‚
â”‚  â””â”€ cancelled = "AnnulÃ©e"                                           â”‚
â”‚                                                                       â”‚
â”‚  OrderStatusHistory                                                  â”‚
â”‚  â”œâ”€ status: String                                                  â”‚
â”‚  â”œâ”€ timestamp: DateTime                                             â”‚
â”‚  â””â”€ note: String?                                                   â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Flux de DonnÃ©es (Data Flow)

### 1. CrÃ©ation d'une commande

```
CheckoutScreen
    â”‚
    â”œâ”€> userProvider.addOrder(...)
    â”‚       â”‚
    â”‚       â”œâ”€> Order.fromCart(cartItems, total, ...)
    â”‚       â”‚
    â”‚       â””â”€> OrderService().addOrder(order)
    â”‚               â”‚
    â”‚               â”œâ”€> _cachedOrders.insert(0, order)
    â”‚               â”‚
    â”‚               â”œâ”€> SharedPreferences.setString('orders_list', json)
    â”‚               â”‚
    â”‚               â””â”€> _ordersController.add(_cachedOrders)
    â”‚                       â”‚
    â”‚                       â””â”€> ordersStream emits
    â”‚                               â”‚
    â”‚                               â””â”€> All listeners notified
    â”‚                                       â”‚
    â”‚                                       â”œâ”€> ordersStreamProvider updates
    â”‚                                       â”œâ”€> filteredOrdersProvider recomputes
    â”‚                                       â”œâ”€> unviewedOrdersProvider recomputes
    â”‚                                       â””â”€> UI rebuilds
    â”‚                                               â”‚
    â”‚                                               â””â”€> NewOrderNotification.show()
    â”‚                                                       â”‚
    â”‚                                                       â”œâ”€> Popup animÃ©
    â”‚                                                       â””â”€> Son notification
```

### 2. Changement de statut

```
OrderDetailPanel
    â”‚
    â”œâ”€> _changeStatus(newStatus)
    â”‚       â”‚
    â”‚       â””â”€> OrderService().updateOrderStatus(orderId, newStatus, note)
    â”‚               â”‚
    â”‚               â”œâ”€> Find order in _cachedOrders
    â”‚               â”‚
    â”‚               â”œâ”€> Add to statusHistory
    â”‚               â”‚
    â”‚               â”œâ”€> Update order.status
    â”‚               â”‚
    â”‚               â”œâ”€> _saveOrders()
    â”‚               â”‚       â”‚
    â”‚               â”‚       â”œâ”€> SharedPreferences save
    â”‚               â”‚       â””â”€> _ordersController.add()
    â”‚               â”‚
    â”‚               â””â”€> Stream emits â†’ UI updates
```

### 3. Filtrage et recherche

```
User Action (FilterDialog / SearchBar)
    â”‚
    â”œâ”€> ordersViewProvider.notifier.setStatusFilter(status)
    â”‚   OR
    â”œâ”€> ordersViewProvider.notifier.setSearchQuery(query)
    â”‚
    â””â”€> OrdersViewState updates
            â”‚
            â””â”€> filteredOrdersProvider recomputes
                    â”‚
                    â”œâ”€> Read ordersStreamProvider
                    â”œâ”€> Apply viewState.statusFilter
                    â”œâ”€> Apply viewState.searchQuery
                    â”œâ”€> Apply viewState.dateRange
                    â””â”€> Apply viewState.sortBy
                            â”‚
                            â””â”€> Return filtered List<Order>
                                    â”‚
                                    â””â”€> UI rebuilds with filtered data
```

## ğŸ¨ Composants Widgets

### HiÃ©rarchie des widgets

```
AdminOrdersScreen (StatefulWidget)
â”œâ”€â”€ Scaffold
â”‚   â”œâ”€â”€ AppBar
â”‚   â”‚   â”œâ”€â”€ Title + Badge (unviewedCount)
â”‚   â”‚   â””â”€â”€ Actions
â”‚   â”‚       â”œâ”€â”€ Toggle view button
â”‚   â”‚       â”œâ”€â”€ Filter button
â”‚   â”‚       â”œâ”€â”€ Export button
â”‚   â”‚       â””â”€â”€ Refresh button
â”‚   â”‚
â”‚   â”œâ”€â”€ FloatingActionButton (Test Data)
â”‚   â”‚
â”‚   â””â”€â”€ Body
â”‚       â”œâ”€â”€ Split view (landscape) OR Stack (portrait)
â”‚       â”‚
â”‚       â””â”€â”€ _buildOrdersList()
â”‚           â”œâ”€â”€ SearchBar + Active Filters
â”‚           â”‚
â”‚           â””â”€â”€ RefreshIndicator
â”‚               â”œâ”€â”€ _buildTableView() [if isTableView]
â”‚               â”‚   â””â”€â”€ DataTable
â”‚               â”‚       â”œâ”€â”€ Headers (sortable)
â”‚               â”‚       â””â”€â”€ Rows (clickable)
â”‚               â”‚           â””â”€â”€ OrderStatusBadge
â”‚               â”‚
â”‚               â””â”€â”€ _buildCardView() [if !isTableView]
â”‚                   â””â”€â”€ GridView
â”‚                       â””â”€â”€ _buildOrderCard()
â”‚                           â””â”€â”€ OrderStatusBadge
â”‚
â””â”€â”€ OrderDetailPanel (conditionally)
    â”œâ”€â”€ Header (close, print)
    â”œâ”€â”€ ScrollView
    â”‚   â”œâ”€â”€ Status section
    â”‚   â”œâ”€â”€ Customer info
    â”‚   â”œâ”€â”€ Pickup details
    â”‚   â”œâ”€â”€ Products list
    â”‚   â”œâ”€â”€ Comment
    â”‚   â”œâ”€â”€ Total
    â”‚   â””â”€â”€ History timeline
    â”‚
    â””â”€â”€ Actions footer
        â”œâ”€â”€ Status change buttons
        â””â”€â”€ Cancel button

Overlay (global)
â””â”€â”€ NewOrderNotification
    â”œâ”€â”€ Animated popup
    â”œâ”€â”€ Sound player
    â””â”€â”€ Auto-dismiss timer
```

## ğŸ“Š Ã‰tat et RÃ©activitÃ©

### Providers Dependency Graph

```
                    orderServiceProvider (singleton)
                              â”‚
                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â†“                         â†“
                  ordersStreamProvider        ordersViewProvider
                  (Stream<List<Order>>)       (OrdersViewState)
                              â”‚                         â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â†“
                          filteredOrdersProvider
                          (List<Order> computed)
                                       â”‚
                                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                       â†“                 â†“
                        unviewedOrdersProvider   UI Consumers
                        (List<Order> computed)   (AdminOrdersScreen)
                                       â”‚
                                       â†“
                        unviewedOrdersCountProvider
                        (int computed)
                                       â”‚
                                       â†“
                              Badge / Notification
```

### State Updates

```
Action                          Updates                    Rebuild
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Add order                    â†’ OrderService cache       â†’ All providers
                             â†’ SharedPreferences        â†’ All UI
                             â†’ Stream emit              â†’ Show notification

Update status                â†’ OrderService cache       â†’ All providers
                             â†’ SharedPreferences        â†’ Detail panel
                             â†’ Stream emit              â†’ List view

Mark as viewed               â†’ OrderService cache       â†’ Unviewed providers
                             â†’ SharedPreferences        â†’ Badge
                             â†’ Stream emit              â†’ Card/Row highlight

Change filter                â†’ ordersViewProvider       â†’ filteredOrders
                                                        â†’ List view only

Search                       â†’ ordersViewProvider       â†’ filteredOrders
                                                        â†’ List view only

Toggle view                  â†’ ordersViewProvider       â†’ View switch
                                                        â†’ List rebuild

Refresh                      â†’ Load from storage        â†’ All providers
                             â†’ Stream emit              â†’ All UI
```

## ğŸ” SÃ©curitÃ© et Performance

### Optimisations

1. **Cache local** : Ã‰vite lectures rÃ©pÃ©tÃ©es de SharedPreferences
2. **Stream broadcast** : Multiple listeners sans duplication
3. **Computed providers** : RecalculÃ©s uniquement si dÃ©pendances changent
4. **Lazy loading** : Providers crÃ©Ã©s Ã  la demande
5. **Filtrage en mÃ©moire** : Pas de requÃªtes supplÃ©mentaires

### Limites actuelles

- Stockage local limitÃ© Ã  ~10MB (suffisant pour milliers de commandes)
- Pas de pagination (OK pour <1000 commandes)
- Pas de sync cloud (utilise SharedPreferences local)
- Son notification nÃ©cessite fichier audio manuel

### Ã‰volutions futures

1. **Firebase/Firestore** : Sync cloud + real-time database
2. **Pagination** : Pour grandes quantitÃ©s de commandes
3. **WebSocket** : Notifications push serveur
4. **Compression** : Pour optimiser stockage local
5. **Indexation** : Pour recherche plus rapide

---

**Document technique** v1.0  
**Auteur** : Pizza Deli'Zza Development Team  
**Date** : Novembre 2024
